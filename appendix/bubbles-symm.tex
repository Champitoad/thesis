\setchapterpreamble[u]{\margintoc}
\chapter{Symmetric Bubble Calculi}
\labch{app:bubbles-symm}

\section{Soundness}\labsec{app:bubbles-soundness}

\begin{lemma}[Generalized weakening]\lablemma{app:bubbles-weakening}
  $\psint{S} \sement \psint{S \mix (\Gamma \seq \Delta)}$.
\end{lemma}
\begin{proof}
  Let $S = \Gamma' \J \Delta'$. We proceed by recurrence on $\bradepth{\J}$.
  \begin{itemize}
    \item[\bcase]
    $$
    \begin{array}{rcll}
      \psint{\Gamma' \seq \Delta'}
      &=& \nsint{\Gamma} \limp \psint{\Delta} & \\
      &\sement& \nsint{\Gamma} \limp \psint{\Delta} \lor \psint{\Delta'} & \\
      &\sement& \nsint{\Gamma'} \wedge \nsint{\Gamma} \limp \psint{\Delta} \lor \psint{\Delta'} & \\
      &=& \psint{\Gamma', \Gamma \seq \Delta, \Delta'} & \\
    \end{array}
    $$
    \item[\rcase]
    $$
    \begin{array}{rcll}
      \psint{\Gamma' \piq{\cS} \Delta'}
      &=& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma' \seq \Delta')}} & \\
      &\sement& \bigwedge_{T \in \cS}{\psint{(T \mix (\Gamma' \seq \Delta')) \mix (\Gamma \seq \Delta)}} &\text{(IH)} \\
      &=& \bigwedge_{T \in \cS}{\psint{T \mix ((\Gamma' \seq \Delta') \mix (\Gamma \seq \Delta))}} & \\
      &=& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma', \Gamma \seq \Delta, \Delta')}} & \\
      &=& \psint{\Gamma', \Gamma \piq{\cS} \Delta, \Delta'} & \\
    \end{array}
    $$
  \end{itemize}
\end{proof}

\begin{lemma}[Generalized contraction]\lablemma{app:bubbles-contraction}
  $\psint{S \mix (\seq I, I)} \semequiv \psint{S \mix (\seq I)}$ and
  $\psint{S \mix (I, I \seq)} \semequiv \psint{S \mix (I \seq)}$.
\end{lemma}
\begin{proof}
  Let $S = \Gamma \J \Delta$. We proceed by recurrence on $\bradepth{\J}$.
  \begin{itemize}
    \item[\bcase]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \seq I, I, \Delta}
      &=& \nsint{\Gamma} \limp (\psint{I} \land \psint{I}) \vee \psint{\Delta} & \\
      &\semequiv& \nsint{\Gamma} \limp \psint{I} \vee \psint{\Delta} &\text{(\reffact{idempotency})} \\
      &=& \psint{\Gamma \seq I, \Delta} & \\
    \end{array}
    $$
    $$
    \begin{array}{rcll}
      \psint{\Gamma, I, I \seq \Delta}
      &=& \nsint{\Gamma} \land (\nsint{I} \land \nsint{I}) \limp \psint{\Delta} & \\
      &\semequiv& \nsint{\Gamma} \land \nsint{I} \limp \psint{\Delta} &\text{(\reffact{idempotency})} \\
      &=& \psint{\Gamma, I \seq \Delta} & \\
    \end{array}
    $$
    \item[\rcase]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\cS} I, I, \Delta}
      &=& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma \seq I, I, \Delta)}} & \\
      &=& \bigwedge_{T \in \cS}{\psint{(T \mix (\Gamma \seq \Delta)) \mix (\seq I, I)}} & \\
      &=& \bigwedge_{T \in \cS}{\psint{(T \mix (\Gamma \seq \Delta)) \mix (\seq I)}} &\text{(IH)} \\
      &=& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma \seq I, \Delta)}} & \\
      &=& \psint{\Gamma \piq{\cS} I, \Delta} & \\
    \end{array}
    $$
    $$
    \begin{array}{rcll}
      \psint{\Gamma, I, I \piq{\cS} \Delta}
      &=& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma, I, I \seq \Delta)}} & \\
      &=& \bigwedge_{T \in \cS}{\psint{(T \mix (\Gamma \seq \Delta)) \mix (I, I \seq)}} & \\
      &=& \bigwedge_{T \in \cS}{\psint{(T \mix (\Gamma \seq \Delta)) \mix (I \seq)}} &\text{(IH)} \\
      &=& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma, I \seq \Delta)}} & \\
      &=& \psint{\Gamma, I \piq{\cS} \Delta} & \\
    \end{array}
    $$
  \end{itemize}
\end{proof}

\begin{lemma}[Generalized weak distributivity]\lablemma{app:bubbles-weakdistrib}
  \begin{align}
    \psint{\Gamma \J \Delta} \lor \psint{I} &\sement \psint{\Gamma \J I, \Delta} \label{app:eqn:weakdistrib-one} \\
    \psint{\Gamma \J I, \Delta} &\sementC \psint{\Gamma \J \Delta} \lor \psint{I} \label{app:eqn:weakdistrib-two} \\
    \nsint{\Gamma, I \J \Delta} &\sementB \nsint{I} \land \nsint{\Gamma \J \Delta} \label{app:eqn:weakdistrib-three} \\
    \nsint{I} \land \nsint{\Gamma \J \Delta} &\sementC \nsint{\Gamma, I \J \Delta} \label{app:eqn:weakdistrib-four}
  \end{align}
\end{lemma}
\begin{proof}
  We only prove (\ref{app:eqn:weakdistrib-one}): the proof of
  (\ref{app:eqn:weakdistrib-two}) is the same, except that we use the converse
  inequality of \reffact{weakdistrib} that holds in Boolean algebras.
  (\ref{app:eqn:weakdistrib-three}) and (\ref{app:eqn:weakdistrib-four}) hold by duality
  from (\ref{app:eqn:weakdistrib-one}) and (\ref{app:eqn:weakdistrib-two}), i.e. for
  (\ref{app:eqn:weakdistrib-three}) we have
  $$
  \def\arraystretch{2.5}
  \begin{array}{rrcll}
               & \psint{\soldual{\Delta} \mathbin{\soldual{\J}} \soldual{\Gamma}} \lor \psint{\soldual{I}} &\sement& \psint{\soldual{\Delta} \mathbin{\soldual{\J}} \soldual{I}, \soldual{\Gamma}} &\text{(\ref{app:eqn:weakdistrib-one})} \\
    \text{iff} & \soldual{\psint{\soldual{\Delta} \mathbin{\soldual{\J}} \soldual{I}, \soldual{\Gamma}}} &\sementB& \soldual{\psint{\soldual{\Delta} \mathbin{\soldual{\J}} \soldual{\Gamma}} \lor \psint{\soldual{I}}} &\text{(\reffact{duality})} \\
    \text{iff} & \nsint{\soldual{\soldual{\Gamma}}, \soldual{\soldual{I}} \mathbin{\soldual{\mathbin{\soldual{\J}}}} \soldual{\soldual{\Delta}}} &\sementB& \nsint{\soldual{\soldual{\Gamma}} \mathbin{\soldual{\mathbin{\soldual{\J}}}} \soldual{\soldual{\Delta}}} \land \nsint{\soldual{\soldual{I}}} &\text{(\reflemma{int-duality})} \\
    \text{iff} & \nsint{\Gamma, I \mathbin{\J} \Delta} &\sementB& \nsint{\Gamma \mathbin{\J} \Delta} \land \nsint{I} &\text{(\reflemma{involutivity})} \\
  \end{array}
  $$
  We prove (\ref{app:eqn:weakdistrib-one}) by recurrence on $\bradepth{\J}$.
  \begin{itemize}
    \item[\bcase]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \seq \Delta} \lor \psint{I}
      &=& \left(\nsint{\Gamma} \limp \psint{\Delta}\right) \lor \psint{I} & \\
      &\sement& \nsint{\Gamma} \limp \psint{\Delta} \lor \psint{I} &\text{(\reffact{weakdistrib})} \\
      &=& \psint{\Gamma \seq I, \Delta} & \\
    \end{array}
    $$
    \item[\rcase]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\cS} \Delta} \lor \psint{I}
      &=& \psintAndMix{(\Gamma' \JB \Delta')}{\cS}{\Gamma}{\Delta} \lor \psint{I} & \\
      &=& \psintAnd{(\Gamma' \JB \Delta')}{\cS}{\Gamma, \Gamma' \JB \Delta', \Delta} \lor \psint{I} & \\
      &\semequiv_{\Lattice}& \psintAnd{(\Gamma' \JB \Delta')}{\cS}{\Gamma, \Gamma' \JB \Delta', \Delta} \lor \psintAnd{(\Gamma' \JB \Delta')}{\cS}{I} &\text{(\reffact{idempotency})} \\
      &\semequiv_{\Lattice}& \bigwedge_{(\Gamma' \JB \Delta') \in \cS}{\left(\psint{\Gamma, \Gamma' \JB \Delta', \Delta} \lor \psint{I}\right)} &\text{(\reffact{distributivity})} \\
      &\sement& \bigwedge_{(\Gamma' \JB \Delta') \in \cS}{\left(\psint{\Gamma, \Gamma' \JB I, \Delta', \Delta} \right)} &\text{(IH)} \\
      &=& \psintAndMix{(\Gamma' \JB \Delta')}{\cS}{\Gamma}{I, \Delta} & \\
      &=& \psint{\Gamma \piq{\cS} I, \Delta} & \\
    \end{array}
    $$
  \end{itemize}
\end{proof}

\begin{lemma}[Generalized currying]\lablemma{app:bubbles-currying}
  \begin{align}
    \psint{\Gamma, I \J \Delta} &\semequiv \nsint{I} \limp \psint{\Gamma \J \Delta} \label{app:eqn:currying-one} \\
    \nsint{\Gamma \J I, \Delta} &\semequiv_{\Brouwer} \nsint{\Gamma \J \Delta} \lsub \psint{I} \label{app:eqn:currying-two}
  \end{align}
\end{lemma}
\begin{proof}
  We only prove (\ref{app:eqn:currying-one}), as (\ref{app:eqn:currying-two}) holds by
  duality as in \reflemma{bubbles-weakdistrib}. We proceed by recurrence on
  $\bradepth{\J}$.
  \begin{itemize}
    \item[\bcase]
    $$
    \begin{array}{rcll}
      \psint{\Gamma, I \seq \Delta}
      &=& \nsint{\Gamma} \land \nsint{I} \limp \psint{\Delta} & \\
      &\semequiv& \nsint{I} \land \nsint{\Gamma} \limp \psint{\Delta} &\text{(\reffact{lattice-commutativity})} \\
      &\semequiv& \nsint{I} \limp \nsint{\Gamma} \limp \psint{\Delta} &\text{(\reffact{currying})} \\
      &=& \nsint{I} \limp \psint{\Gamma \seq \Delta} & \\
    \end{array}
    $$
    \item[\rcase]
    $$
    \begin{array}{rcll}
      \psint{\Gamma, I \piq{\cS} \Delta}
      &=& \psintAndMix{(\Gamma' \JB \Delta')}{\cS}{\Gamma, I}{\Delta} & \\
      &=& \psintAnd{(\Gamma' \JB \Delta')}{\cS}{\Gamma', \Gamma, I \JB \Delta, \Delta'} & \\
      &\semequiv& \bigwedge_{(\Gamma' \JB \Delta') \in \cS}{\left(\nsint{I} \limp \psint{\Gamma', \Gamma \JB \Delta, \Delta'}\right)} &\text{(IH)} \\
      &\semequiv& \nsint{I} \limp \bigwedge_{(\Gamma' \JB \Delta') \in \cS}{\psint{\Gamma', \Gamma \JB \Delta, \Delta'}} &\text{(\reffact{distributivity})} \\
      &=& \nsint{I} \limp \bigwedge_{(\Gamma' \JB \Delta') \in \cS}{\psint{(\Gamma' \JB \Delta') \mix (\Gamma \seq \Delta)}} & \\
      &=& \nsint{I} \limp \psint{\Gamma \piq{\cS} \Delta} & \\
    \end{array}
    $$
  \end{itemize}
\end{proof}

\begin{lemma}[Local soundness]\lablemma{app:bubbles-local-soundness}
  
  If $S \lstep{} T$ then $\psint{T \mix (\Gamma \seq \Delta)} \sementC \psint{S
  \mix (\Gamma \seq \Delta)}$.
\end{lemma}
\begin{proof}
  We show that $S \lstep{} T$ implies $\psint{T} \sementC \psint{S}$ by inspection
  of each rule of \kl{system~B}. That we can mix an arbitrary top-level context
  $\Gamma \seq \Delta$ into $S$ and $T$ follows from \reffact{bubbles-top-level}.

  \def\arraystretch{1.25}
  \begin{itemize}
    \item[\rsf{i{\da}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{} \Delta}
      &=& \bigwedge_{U \in \emptyset}{\psint{U \mix (\Gamma \seq \Delta)}} &\\
      &=& \top & \\
      &\semequiv& \nsint{\Gamma} \wedge A \limp A \lor \psint{\Delta} &\\
      &=& \psint{\Gamma, A \seq A, \Delta}
    \end{array}
    $$
    \item[\rsf{i{\ua}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\seq A \sep A \seq} \Delta}
      &=& \psint{\Gamma \seq A, \Delta} \wedge \psint{\Gamma, A \seq \Delta} & \\
      &=& (\nsint{\Gamma} \limp A \lor \psint{\Delta}) \land (\nsint{\Gamma} \land A \limp \psint{\Delta}) & \\
      &\semequiv& (\nsint{\Gamma} \limp A \lor \psint{\Delta}) \wedge (\nsint{\Gamma} \limp A \limp \psint{\Delta}) &\text{(\reffact{currying})}\\
      &\semequiv& \nsint{\Gamma} \limp (A \lor \psint{\Delta}) \wedge (A \limp \psint{\Delta}) &\text{(\reffact{distributivity})}\\
      &\semequiv& \nsint{\Gamma} \limp \psint{\Delta} &\text{(\reffact{gencut})}\\
      &=& \psint{\Gamma \seq \Delta} & \\
    \end{array}
    $$
    \item[{\rsf{w{-}}}, {\rsf{w{+}}}] By \reflemma{bubbles-weakening}.
    \item[{\rsf{c{-}}}, {\rsf{c{+}}}] By \reflemma{bubbles-contraction}.

    % Soundness of membrane rules for non-empty bubbles instead of bubble
    % swapping rules. Pro: invertible. Con: completeness might be harder to
    % prove.

    % \item[{\rsf{s{-}}}, {\rsf{s{+}}}] We only write the proof for
    % {\rsf{s{-}}}, the proof for {\rsf{s{+}}} is symmetric. We proceed by
    % recurrence on $\bradepth{\J}$.
    % \begin{itemize}
    %   \item[\bcase]
    %   $$
    %   \begin{array}{rcll}
    %     \psint{\piq{S \seq} \mix \Gamma \seq \Delta}
    %     &=& \psint{\Gamma \piq{S \seq} \Delta} & \\
    %     &=& \psint{\Gamma, S \seq \Delta} & \\
    %     &=& \nsint{\Gamma} \wedge \nsint{S} \limp \psint{\Delta} & \\
    %     &=& \nsint{\Gamma} \wedge \nsint{\piq{S}} \limp \psint{\Delta} & \\
    %     &=& \psint{\Gamma, (\piq{S}) \seq \Delta} & \\
    %   \end{array}
    %   $$
    %   \item[\rcase]
    %   $$
    %   \begin{array}{rcll}
    %     \psint{\piq{S \seq} \mix \Gamma \piq{\cS} \Delta}
    %     &=& \psint{\Gamma \piq{\cS \sep S \seq} \Delta} & \\
    %     &=& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma \seq \Delta)}} \land \psint{\Gamma, S \seq \Delta} & \\
    %     &=& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma \seq \Delta)}} \land \psint{(\Gamma \seq \Delta) \mix (S \seq)} & \\
    %     &\semequiv& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma \seq \Delta)}} \land \bigwedge_{T\in\cS}{\psint{(\Gamma \seq \Delta) \mix (S \seq)}} & \\
    %     &\sement& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma \seq \Delta) \mix (\Gamma \seq \Delta) \mix (S \seq)}} &\text{(\reflemma{bubbles-mix})} \\
    %     &\semequiv& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma \seq \Delta) \mix (S \seq)}} &\text{(\reflemma{bubbles-contraction})} \\
    %     &\sement& \bigwedge_{T \in \cS}{\psint{T \mix (\Gamma \seq \Delta) \mix \piq{S \seq}}} &\text{(\reflemma{bubbles-piq})} \\
    %     &=& \bigwedge_{T \in \cS}{\psint{\piq{S \seq} \mix ((\Gamma \seq \Delta) \mix T)}} & \\
    %     &=& \bigwedge_{(\Gamma' \JB \Delta') \in \cS}{\psint{\piq{S \seq} \mix ((\Gamma \seq \Delta) \mix (\Gamma' \JB \Delta'))}} & \\
    %     &=& \bigwedge_{(\Gamma' \JB \Delta') \in \cS}{\psint{\piq{S \seq} \mix (\Gamma', \Gamma \JB \Delta, \Delta')}} & \\
    %     &\sement& \bigwedge_{(\Gamma' \JB \Delta') \in \cS}{\psint{\Gamma', \Gamma, (\piq{S}) \JB \Delta, \Delta'}} &\text{(IH)} \\
    %     &=& \bigwedge_{(\Gamma' \JB \Delta') \in \cS}{\psint{(\Gamma' \JB \Delta') \mix (\Gamma, (\piq{S}) \seq \Delta)}} & \\
    %     &=& \psint{\Gamma, (\piq{S}) \piq{\cS} \Delta} & \\
    %   \end{array}
    %   $$
    % \end{itemize}

    \item[{\rsf{f{\ua}}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\cS \sep \Gamma' \piq{\cS'} \Delta' \sep S} \Delta}
      &=& \psintAndMix{T}{\cS}{\Gamma}{\Delta} \land \psint{\Gamma, \Gamma' \piq{\cS'} \Delta', \Delta} \land \psint{S \mix (\Gamma \seq \Delta)} & \\
      &\sement& \psintAndMix{T}{\cS}{\Gamma}{\Delta} \land \psint{\Gamma, \Gamma' \piq{\cS'} \Delta', \Delta} \land \psint{S \mix (\Gamma, \Gamma' \seq \Delta', \Delta)} &\text{(\reflemma{bubbles-weakening})} \\
      &=& \psint{\Gamma \piq{\cS \sep \Gamma' \piq{\cS' \sep S} \Delta'} \Delta} & \\
    \end{array}
    $$

    \item[{\rsf{f{-}{\da}}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\Gamma', I \JB \Delta' \sep \cS} \Delta}
      &=& \psint{\Gamma, \Gamma', I \JB \Delta', \Delta} \land \bigwedge_{S \in \cS}{\psint{S \mix (\Gamma \seq \Delta)}} & \\
      &=& \psint{\Gamma, I \piq{\Gamma' \JB \Delta' \sep \cS} \Delta} & \\
    \end{array}
    $$
    \item[{\rsf{f{+}{\da}}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\cS \sep \Gamma' \JB I, \Delta'} \Delta}
      &=& \bigwedge_{S \in \cS}{\psint{S \mix (\Gamma \seq \Delta)}} \land \psint{\Gamma, \Gamma' \JB I, \Delta', \Delta} & \\
      &=& \psint{\Gamma \piq{\cS \sep \Gamma' \JB \Delta'} I, \Delta} & \\
    \end{array}
    $$
    \item[{\rsf{f{-}{+}{\da}}}]
    We show that $\psint{\Gamma \J (\Gamma', I \JB \Delta'), \Delta} \sement
    \psint{\Gamma, I \J (\Gamma' \JB \Delta'), \Delta}$ by recurrence on
    $\bradepth{\J}$.
    \begin{itemize}
      \item[\bcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma \seq (\Gamma', I \JB \Delta'), \Delta}
        &=& \nsint{\Gamma} \limp \psint{\Gamma', I \JB \Delta'} \lor \psint{\Delta} & \\
        &\semequiv& \nsint{\Gamma} \limp \left(\nsint{I} \limp \psint{\Gamma' \JB \Delta'}\right) \lor \psint{\Delta} &\text{(\reflemma{bubbles-currying})} \\
        &\sement& \nsint{\Gamma} \limp \left(\nsint{I} \limp \psint{\Gamma' \JB \Delta'} \lor \psint{\Delta}\right) &\text{(\reffact{weakdistrib})} \\
        &\semequiv& \nsint{\Gamma} \land \nsint{I} \limp \psint{\Gamma' \JB \Delta'} \lor \psint{\Delta} &\text{(\reffact{currying})} \\
        &=& \psint{\Gamma, I \seq (\Gamma' \JB \Delta'), \Delta} & \\
      \end{array}
      $$
      \item[\rcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma \piq{\cS} (\Gamma', I \JB \Delta'), \Delta}
        &=& \psintAndMix{(\Gamma'' \J \Delta'')}{\cS}{\Gamma}{(\Gamma', I \JB \Delta'), \Delta} & \\
        &=& \psintAnd{(\Gamma'' \J \Delta'')}{\cS}{\Gamma'', \Gamma \J (\Gamma', I \JB \Delta'), \Delta, \Delta''} & \\
        &\sement& \psintAnd{(\Gamma'' \J \Delta'')}{\cS}{\Gamma'', \Gamma, I \J (\Gamma' \JB \Delta'), \Delta, \Delta''} &\text{(IH)} \\
        &=& \psintAndMix{(\Gamma'' \J \Delta'')}{\cS}{\Gamma, I}{(\Gamma' \JB \Delta'), \Delta} & \\
        &=& \psint{\Gamma, I \piq{\cS} (\Gamma' \JB \Delta'), \Delta} & \\
      \end{array}
      $$
    \end{itemize}
    \item[{\rsf{f{+}{-}{\da}}}]
    We show that $\psint{\Gamma, (\Gamma' \JB I, \Delta') \J \Delta} \sementHB
    \psint{\Gamma, (\Gamma' \JB \Delta') \J I, \Delta}$ by recurrence on
    $\bradepth{\J}$.
    \begin{itemize}
      \item[\bcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma, (\Gamma' \JB I, \Delta') \seq \Delta}
        &=& \nsint{\Gamma} \land \nsint{\Gamma' \JB I, \Delta'} \limp \psint{\Delta} & \\
        &\semequiv_{\HeytingBrouwer}& \nsint{\Gamma} \land \left(\nsint{\Gamma' \JB \Delta'} \lsub \psint{I}\right) \limp \psint{\Delta} &\text{(\reflemma{bubbles-currying})} \\
        &\sementHB& \left(\nsint{\Gamma} \land \nsint{\Gamma' \JB \Delta'} \lsub \psint{I}\right) \limp \psint{\Delta} &\text{(\reffact{weakdistrib})} \\
        &\sementHB& \nsint{\Gamma} \land \nsint{\Gamma' \JB \Delta'} \limp \psint{I} \lor \psint{\Delta} &\text{(\reffact{impsub})} \\
        &=& \psint{\Gamma, (\Gamma' \JB \Delta') \seq I, \Delta} & \\
      \end{array}
      $$
      \item[\rcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma, (\Gamma' \JB I, \Delta') \piq{\cS} \Delta}
        &=& \psintAndMix{(\Gamma'' \J \Delta'')}{\cS}{\Gamma, (\Gamma' \JB I, \Delta')}{\Delta} & \\
        &=& \psintAnd{(\Gamma'' \J \Delta'')}{\cS}{\Gamma'', \Gamma, (\Gamma' \JB I, \Delta') \J \Delta, \Delta''} & \\
        &\sementHB& \psintAnd{(\Gamma'' \J \Delta'')}{\cS}{\Gamma'', \Gamma, (\Gamma' \JB \Delta') \J I, \Delta, \Delta''} &\text{(IH)} \\
        &=& \psintAndMix{(\Gamma'' \J \Delta'')}{\cS}{\Gamma, (\Gamma' \JB \Delta')}{I, \Delta} & \\
        &=& \psint{\Gamma, (\Gamma' \JB \Delta') \piq{\cS} I, \Delta} & \\
      \end{array}
      $$
    \end{itemize}
    \item[{\rsf{f{+}{+}{\ua}}}]
    We show that $\psint{\Gamma \J (\Gamma' \JB \Delta'), I, \Delta} \sement
    \psint{\Gamma \J (\Gamma' \JB I, \Delta'), \Delta}$ by recurrence on
    $\bradepth{\J}$.
    \begin{itemize}
      \item[\bcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma \seq (\Gamma' \JB \Delta'), I, \Delta}
        &=& \nsint{\Gamma} \limp \psint{\Gamma' \JB \Delta'} \lor \psint{I} \lor \psint{\Delta} & \\
        &\sement& \nsint{\Gamma} \limp \psint{\Gamma' \JB I, \Delta'} \lor \psint{\Delta} &\text{(\reflemma{bubbles-weakdistrib})} \\
        &=& \psint{\Gamma \seq (\Gamma' \JB I, \Delta'), \Delta} & \\
      \end{array}
      $$
      \item[\rcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma \piq{\cS} (\Gamma' \JB \Delta'), I, \Delta}
        &=& \psintAndMix{(\Gamma'' \J \Delta'')}{\cS}{\Gamma}{(\Gamma' \JB \Delta'), I, \Delta} & \\
        &=& \psintAnd{(\Gamma'' \J \Delta'')}{\cS}{\Gamma'', \Gamma \J (\Gamma' \JB \Delta'), I, \Delta, \Delta''} & \\
        &\sement& \psintAnd{(\Gamma'' \J \Delta'')}{\cS}{\Gamma'', \Gamma \J (\Gamma' \JB I, \Delta'), \Delta, \Delta''} &\text{(IH)} \\
        &=& \psintAndMix{(\Gamma'' \J \Delta'')}{\cS}{\Gamma}{(\Gamma' \JB I, \Delta'), \Delta} & \\
        &=& \psint{\Gamma \piq{\cS} (\Gamma' \JB I, \Delta'), \Delta} & \\
      \end{array}
      $$
    \end{itemize}
    \item[{\rsf{f{-}{-}{\ua}}}]
    We show that $\psint{\Gamma, I, (\Gamma' \JB \Delta') \J \Delta} \sementHB
    \psint{\Gamma, (\Gamma', I \JB \Delta') \J \Delta}$ by recurrence on
    $\bradepth{\J}$.
    \begin{itemize}
      \item[\bcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma, I, (\Gamma' \JB \Delta') \seq \Delta}
        &=& \nsint{\Gamma} \land \nsint{I} \land \nsint{\Gamma' \JB \Delta'} \limp \psint{\Delta} & \\
        &\sementHB& \nsint{\Gamma} \land \nsint{\Gamma', I \JB \Delta'} \limp \psint{\Delta} &\text{(\reflemma{bubbles-weakdistrib})} \\
        &=& \psint{\Gamma, (\Gamma', I \JB \Delta') \seq \Delta} & \\
      \end{array}
      $$
      \item[\rcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma, I, (\Gamma' \JB \Delta') \piq{\cS} \Delta}
        &=& \psintAndMix{(\Gamma'' \J \Delta'')}{\cS}{\Gamma, I, (\Gamma' \JB \Delta')}{\Delta} & \\
        &=& \psintAnd{(\Gamma'' \J \Delta'')}{\cS}{\Gamma'', \Gamma, I, (\Gamma' \JB \Delta') \J \Delta, \Delta''} & \\
        &\sementHB& \psintAnd{(\Gamma'' \J \Delta'')}{\cS}{\Gamma'', \Gamma, (\Gamma', I \JB \Delta') \J \Delta, \Delta''} &\text{(IH)} \\
        &=& \psintAndMix{(\Gamma'' \J \Delta'')}{\cS}{\Gamma, (\Gamma', I \JB \Delta')}{\Delta} & \\
        &=& \psint{\Gamma, (\Gamma', I \JB \Delta') \piq{\cS} \Delta} & \\
      \end{array}
      $$
    \end{itemize}

    \item[{\rsf{f{-}{+}{\ua}}}, {\rsf{f{+}{-}{\ua}}}] Converse of
    {\rsf{f{-}{+}{\da}}} (resp. {\rsf{f{+}{-}{\da}}}), using
    the converse inequality of \reffact{weakdistrib} which only holds in
    Boolean algebras.

    \item[{\rsf{f{+}{+}{\da}}}, {\rsf{f{-}{-}{\da}}}] Converse
    of {\rsf{f{+}{+}{\ua}}} (resp. {\rsf{f{-}{-}{\ua}}}), using
    the converse inequality of \reflemma{bubbles-weakdistrib} which only holds
    in Boolean algebras.

    \item[\rsf{p}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\cS} \Delta}
      &=& \psintAndMix{S}{\cS}{\Gamma}{\Delta} \\
      &\semequiv_{\Lattice}& \psintAndMix{S}{\cS}{\Gamma}{\Delta} \wedge \top \\
      &=& \psintAndMix{S}{\cS}{\Gamma}{\Delta} \wedge \psint{\Gamma \piq{} \Delta} \\
      &=& \psint{\Gamma \piq{\cS \sep \piq{}} \Delta} \\
    \end{array}
    $$

    \item[\rsf{p{-}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{} \Delta}
      &=& \top & \\
      &\semequiv& \nsint{\Gamma} \wedge \bot \limp \psint{\Delta} & \\
      &=& \psint{\Gamma, (\piq{}) \seq \Delta} & \\
    \end{array}
    $$

    \item[\rsf{p{+}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{} \Delta}
      &=& \top & \\
      &\semequiv& \nsint{\Gamma} \limp \top \lor \psint{\Delta} & \\
      &=& \psint{\Gamma \seq (\piq{}), \Delta} & \\
    \end{array}
    $$

    \item[\rsf{a}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{S} \Delta}
      &=& \psint{\piq{S} \mix (\Gamma \seq \Delta)} & \\
      &=& \psint{\Gamma \piq{\piq{S}} \Delta} & \\
    \end{array}
    $$

    \item[\rsf{a{-}}, \rsf{a{+}}] We only do the proof for \rsf{a{-}}, the proof
    for \rsf{a{+}} is symmetric. We show that $\psint{\Gamma, S \J \Delta} =
    \psint{\Gamma, (\piq{S}) \J \Delta}$ by recurrence on $\bradepth{\J}$.
    \begin{itemize}
      \item[\bcase]
        $$
        \begin{array}{rcll}
          \psint{\Gamma, S \seq \Delta}
          &=& \nsint{\Gamma} \land \nsint{S} \limp \psint{\Delta} & \\
          &=& \nsint{\Gamma} \land \nsint{\piq{S}} \limp \psint{\Delta} & \\
          &=& \psint{\Gamma, (\piq{S}) \seq \Delta} & \\
        \end{array}
        $$
      \item[\rcase]
        $$
        \begin{array}{rcll}
          \psint{\Gamma, S \piq{\cS} \Delta}
          &=& \psintAndMix{T}{\cS}{\Gamma, S}{\Delta} & \\
          &=& \psintAndMix{T}{\cS}{\Gamma, (\piq{S})}{\Delta} &\text{(IH)} \\
          &=& \psint{\Gamma, (\piq{S}) \piq{\cS} \Delta} & \\
        \end{array}
        $$
    \end{itemize}
    
    \item[\rsf{\top{-}}, \rsf{\bot{+}}]
    We only do the proof for \rsf{\top{-}}, the proof for \rsf{\bot{+}} is
    symmetric. We show that $\psint{\Gamma \J \Delta} \semequiv \psint{\Gamma,
    \top \J \Delta}$ by recurrence on $\bradepth{\J}$.
    \begin{itemize}
      \item[\bcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma \seq \Delta}
        &=& \nsint{\Gamma} \limp \psint{\Delta} & \\
        &\semequiv& \nsint{\Gamma} \land \top \limp \psint{\Delta} & \\
        &=& \psint{\Gamma, \top \seq \Delta}
      \end{array}
      $$
      \item[\rcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma \piq{\cS} \Delta}
        &=& \psintAndMix{S}{\cS}{\Gamma}{\Delta} & \\
        &\semequiv& \psintAndMix{S}{\cS}{\Gamma, \top}{\Delta} &\text{(IH)} \\
        &=& \psint{\Gamma, \top \piq{\cS} \Delta} & \\
      \end{array}
      $$
    \end{itemize}

    \item[\rsf{\top{+}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{} \Delta}
      &=& \top & \\
      &\semequiv& \nsint{\Gamma} \limp \top \lor \psint{\Delta} & \\
      &=& \psint{\Gamma \seq \top, \Delta}
    \end{array}
    $$

    \item[\rsf{\bot{-}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{} \Delta}
      &=& \top & \\
      &\semequiv& \nsint{\Gamma} \land \bot \limp \psint{\Delta} & \\
      &=& \psint{\Gamma, \bot \seq \Delta}
    \end{array}
    $$

    \item[\rsf{\land{-}}, \rsf{\lor{+}}]
    We only do the proof for \rsf{\land{-}}, the proof for \rsf{\lor{+}} is
    symmetric. We show that $\psint{\Gamma, A, B \J \Delta} = \psint{\Gamma, A
    \land B \J \Delta}$ by recurrence on $\bradepth{\J}$.
    \begin{itemize}
      \item[\bcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma, A, B \seq \Delta}
        &=& \nsint{\Gamma} \land A \land B \limp \psint{\Delta} & \\
        &=& \psint{\Gamma, A \land B \seq \Delta}
      \end{array}
      $$
      \item[\rcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma, A, B \piq{\cS} \Delta}
        &=& \psintAndMix{S}{\cS}{\Gamma, A, B}{\Delta} & \\
        &=& \psintAndMix{S}{\cS}{\Gamma, A \land B}{\Delta} &\text{(IH)} \\
        &=& \psint{\Gamma, A \land B \piq{\cS} \Delta} & \\
      \end{array}
      $$
    \end{itemize}

    \item[\rsf{\land{+}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\seq A \sep \seq B} \Delta}
      &=& \psint{\Gamma \seq A, \Delta} \land \psint{\Gamma \seq B, \Delta} & \\
      &=& \left(\nsint{\Gamma} \limp A \lor \psint{\Delta}\right) \land \left(\nsint{\Gamma} \limp B \lor \psint{\Delta}\right) & \\
      &\semequiv& \nsint{\Gamma} \limp \left(A \lor \psint{\Delta}\right) \land \left(B \lor \psint{\Delta}\right) &\text{(\reffact{distributivity})} \\
      &\semequiv& \nsint{\Gamma} \limp \left(\psint{\Delta} \lor A\right) \land \left(\psint{\Delta} \lor B\right) &\text{(\reffact{lattice-commutativity})} \\
      &\semequiv& \nsint{\Gamma} \limp \psint{\Delta} \lor \left(A \land B\right) &\text{(\reffact{distributivity})} \\
      &\semequiv& \nsint{\Gamma} \limp \left(A \land B\right) \lor \psint{\Delta} &\text{(\reffact{lattice-commutativity})} \\
      &=& \psint{\Gamma \seq A \land B, \Delta} & \\
    \end{array}
    $$

    \item[\rsf{\lor{-}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{A \seq \sep B \seq} \Delta}
      &=& \psint{\Gamma, A \seq \Delta} \land \psint{\Gamma, B \seq \Delta} & \\
      &=& \left(\nsint{\Gamma} \land A \limp \psint{\Delta}\right) \land \left(\nsint{\Gamma} \land B \limp \psint{\Delta}\right) & \\
      &\semequiv& \left(\nsint{\Gamma} \land A\right) \lor \left(\nsint{\Gamma} \land B\right) \limp \psint{\Delta} &\text{(\reffact{distributivity})} \\
      &\semequiv& \nsint{\Gamma} \land \left(A \lor B\right) \limp \psint{\Delta} &\text{(\reffact{distributivity})} \\
      &=& \psint{\Gamma, A \lor B \seq \Delta} & \\
    \end{array}
    $$

    \item[\rsf{{\limp}{+}}, \rsf{{\lsub}{-}}]
    We only do the proof for \rsf{{\limp}{+}}, the proof for \rsf{{\lsub}{-}} is
    symmetric. We show that $\psint{\Gamma \J (A \seq B), \Delta} =
    \psint{\Gamma \J A \limp B, \Delta}$ by recurrence on $\bradepth{\J}$.
    \begin{itemize}
      \item[\bcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma \seq (A \seq B), \Delta}
        &=& \nsint{\Gamma}\limp \psint{A \seq B} \lor \psint{\Delta} & \\
        &=& \nsint{\Gamma}\limp (A \limp B) \lor \psint{\Delta} & \\
        &=& \psint{\Gamma \seq A \limp B, \Delta}
      \end{array}
      $$
      \item[\rcase]
      $$
      \begin{array}{rcll}
        \psint{\Gamma \piq{\cS} (A \seq B), \Delta}
        &=& \psintAndMix{S}{\cS}{\Gamma}{(A \seq B), \Delta} & \\
        &=& \psintAndMix{S}{\cS}{\Gamma}{A \limp B, \Delta} &\text{(IH)} \\
        &=& \psint{\Gamma \piq{\cS} A \limp B, \Delta} & \\
      \end{array}
      $$
    \end{itemize}
    
    \item[\rsf{{\limp}{-}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\seq A \sep B \seq} \Delta}
      &=& \psint{\Gamma \seq A, \Delta} \land \psint{\Gamma, B \seq \Delta} & \\
      &=& \left(\nsint{\Gamma} \limp A \lor \psint{\Delta} \right) \land \left(\nsint{\Gamma} \land B \limp \psint{\Delta} \right) & \\
      &\semequiv& \left(\nsint{\Gamma} \limp A \lor \psint{\Delta} \right) \land \left(\nsint{\Gamma} \limp B \limp \psint{\Delta} \right) &\text{(\reffact{currying})} \\
      &\semequiv& \nsint{\Gamma} \limp \left(A \lor \psint{\Delta} \right) \land \left(B \limp \psint{\Delta} \right) &\text{(\reffact{distributivity})} \\
      &\sement& \nsint{\Gamma} \limp (A \limp B) \limp \psint{\Delta} \lor \psint{\Delta} &\text{(\reffact{gencut})} \\
      &\semequiv& \nsint{\Gamma} \limp (A \limp B) \limp \psint{\Delta} &\text{(\reffact{idempotency})} \\
      &\semequiv& \nsint{\Gamma} \land (A \limp B) \limp \psint{\Delta} &\text{(\reffact{currying})} \\
      &=& \psint{\Gamma, A \limp B \seq \Delta} & \\
    \end{array}
    $$

    \item[\rsf{{\lsub}{+}}]
    $$
    \begin{array}{rcll}
      \psint{\Gamma \piq{\seq A \sep B \seq} \Delta}
      &=& \psint{\Gamma \seq A, \Delta} \land \psint{\Gamma, B \seq \Delta} & \\
      &=& \left(\nsint{\Gamma} \limp A \lor \psint{\Delta} \right) \land \left(\nsint{\Gamma} \land B \limp \psint{\Delta} \right) & \\
      &\semequiv& \left(\nsint{\Gamma} \limp A \lor \psint{\Delta} \right) \land \left(\nsint{\Gamma} \limp B \limp \psint{\Delta} \right) &\text{(\reffact{currying})} \\
      &\semequiv& \nsint{\Gamma} \limp \left(A \lor \psint{\Delta} \right) \land \left(B \limp \psint{\Delta} \right) &\text{(\reffact{distributivity})} \\
      &\sement& \nsint{\Gamma} \limp (A \lsub B) \lor \psint{\Delta} \lor \psint{\Delta} &\text{(\reffact{gencut})} \\
      &\semequiv& \nsint{\Gamma} \limp (A \lsub B) \lor \psint{\Delta} &\text{(\reffact{idempotency})} \\
      &=& \psint{\Gamma \seq A \lsub B, \Delta} & \\
    \end{array}
    $$
  \end{itemize}
\end{proof}

\section{Completeness}\labsec{app:bubbles-completeness}

In the following proofs, we will denote a sequence of applications of a set of
rules by a double inference line, and the use of a derivation obtained by
induction hypothesis by a dotted line.

\begin{lemma}[Simulation of \kl{DBiInt}]\lablemma{app:simulation-dbiint}
  
  If $X \prov{\kl{DBiInt}} Y$ then $X \prov{\sysBHB \setminus
  \{\rsf{i{\ua}}\}} Y$.
\end{lemma}
\begin{proof}
  By induction on the derivation of $X \prov{\kl{DBiInt}} Y$. 
  \begin{align*}
    \R[\rsf{id}]
      {}
      {X, A \seq A, Y}
    &\mt
    \R[\rsf{i{\da}}]
    {\prftree[r][d]{\rsf{w{-},w{+}}}
    {\piq{}}
    {X \piq{} Y}}
    {X, A \seq A, Y}
    \\\\
    \R[\rsf{\seq_{L1}}]
      {\summ[$\pi_1$]{X, A, (X', A \seq Y') \seq Y}}
      {X, (X', A \seq Y') \seq Y}
    &\mt
    \R[\rsf{c{-}}]
    {\R[\rsf{f{-}{-}{\ua}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {X, A, (X', A \seq Y') \seq Y}}
    {X, (X', A, A \seq Y') \seq Y}}
    {X, (X', A \seq Y') \seq Y}
    \\\\
    \R[\rsf{\seq_{R1}}]
      {\summ[$\pi_1$]{X \seq  (X' \seq A, Y'), A, Y}}
      {X \seq (X' \seq A, Y'), Y}
    &\mt
    \R[\rsf{c{+}}]
    {\R[\rsf{f{+}{+}{\ua}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {X \seq (X' \seq A, Y'), A, Y}}
    {X \seq (X' \seq A, A, Y'), Y}}
    {X \seq (X' \seq A, Y'), Y}
    \\\\
    \R[\rsf{\seq_{L2}}]
      {\summ[$\pi_1$]{X, A \seq (X', A \seq Y'), Y}}
      {X, A \seq (X' \seq Y'), Y}
    &\mt
    \R[\rsf{c{-}}]
    {\R[\rsf{f{-}{+}{\da}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {X, A \seq (X', A \seq Y'), Y}}
    {X, A, A \seq (X' \seq Y'), Y}}
    {X, A \seq (X' \seq Y'), Y}
    \\\\
    \R[\rsf{\seq_{R2}}]
      {X, (X' \seq A, Y') \seq A, Y}
      {X, (X' \seq Y') \seq A, Y}
    &\mt
    \R[\rsf{c{+}}]
    {\R[\rsf{f{+}{-}{\da}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {X, (X' \seq A, Y') \seq A, Y}}
    {X, (X' \seq Y') \seq A, A, Y}}
    {X, (X' \seq Y') \seq A, Y}
    \\\\
    \R[\rsf{\bot_L}]
      {}
      {X, \bot \seq Y}
    &\mt
    \R[\rsf{\bot{-}}]
    {\prftree[r][d]{\rsf{w{-},w{+}}}
    {\piq{}}
    {X \piq{} Y}}
    {X, \bot \seq Y}
    \\\\
    \R[\rsf{\top_R}]
      {}
      {X \seq \top, Y}
    &\mt
    \R[\rsf{\top{+}}]
    {\prftree[r][d]{\rsf{w{-},w{+}}}
    {\piq{}}
    {X \piq{} Y}}
    {X \seq \top, Y}
    \\\\
    \R[\rsf{\land_L}]
      {\summ[$\pi_1$]{X, A \land B, A, B \seq Y}}
      {X, A \land B \seq Y}
    &\mt
    \R[\rsf{c{-}}]
    {\R[\rsf{\land{-}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {X, A \land B, A, B \seq Y}}
    {X, A \land B, A \land B \seq Y}}
    {X, A \land B \seq Y}
    \\\\
    \R[\rsf{\lor_R}]
      {\summ[$\pi_1$]{X \seq A, B, A \lor B, Y}}
      {X \seq A \lor B, Y}
    &\mt
    \R[\rsf{c{+}}]
    {\R[\rsf{\lor{+}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {X \seq A, B, A \lor B \seq Y}}
    {X \seq A \lor B, A \lor B, Y}}
    {X \seq A \lor B, Y}
    \\\\
    \R[\rsf{\land_R}]
      {\summ[$\pi_1$]{X \seq A, A \land B, Y}}
      {\summ[$\pi_2$]{X \seq B, A \land B, Y}}
      {X \seq A \land B, Y}
    &\mt
    \R[\rsf{c{+}}]
    {\R[\rsf{\land{+}}]
    {\prftree[r][d]{\rsf{c{-},c{+}}}
    {\prftree[r][d]{\rsf{f{-},f{+}}}
    {\prftree[r][dotted]{$\pi_1$}
    {\prftree[r][dotted]{$\pi_2$}
    {\prftree[r][d]{\rsf{p}}
    {\piq{}}
    {\piq{\piq{} \sep \piq{}}}}
    {\piq{\piq{} \sep X \seq B, A \land B, Y}}}
    {\piq{X \seq A, A \land B, Y \sep X \seq B, A \land B, Y}}}
    {X, X \piq{\seq A \sep \seq B} A \land B, A \land B, Y, Y}}
    {X \piq{\seq A \sep \seq B} A \land B, Y}}
    {X \seq A \land B, A \land B, Y}}
    {X \seq A \land B, Y}
    \\\\
    \R[\rsf{\lor_L}]
      {\summ[$\pi_1$]{X, A \lor B, A \seq Y}}
      {\summ[$\pi_2$]{X, A \lor B, B \seq Y}}
      {X, A \lor B \seq Y}
    &\mt
    \R[\rsf{c{-}}]
    {\R[\rsf{\lor{-}}]
    {\prftree[r][d]{\rsf{c{-},c{+}}}
    {\prftree[r][d]{\rsf{f{-},f{+}}}
    {\prftree[r][dotted]{$\pi_1$}
    {\prftree[r][dotted]{$\pi_2$}
    {\prftree[r][d]{\rsf{p}}
    {\piq{}}
    {\piq{\piq{} \sep \piq{}}}}
    {\piq{\piq{} \sep X, A \lor B, B \seq Y}}}
    {\piq{X, A \lor B, A \seq Y \sep X, A \lor B, B \seq Y}}}
    {X, X, A \lor B, A \lor B \piq{A \seq \sep B \seq} Y, Y}}
    {X, A \lor B \piq{A \seq \sep B \seq} Y}}
    {X, A \lor B, A \lor B \seq Y}}
    {X, A \lor B \seq Y}
    \\\\
    \R[\rsf{\limp_R}]
      {\summ[$\pi_1$]{X \seq (A \seq B), A \limp B, Y}}
      {X \seq A \limp B, Y}
    &\mt
    \R[\rsf{c{+}}]
    {\R[\rsf{{\limp}{+}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {X \seq (A \seq B), A \limp B, Y}}
    {X \seq A \limp B, A \limp B, Y}}
    {X \seq A \limp B, Y}
    \\\\
    \R[\rsf{\lsub_L}]
      {\summ[$\pi_1$]{X, A \lsub B, (A \seq B) \seq Y}}
      {X, A \lsub B \seq Y}
    &\mt
    \R[\rsf{c{-}}]
    {\R[\rsf{{\lsub}{-}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {X, A \lsub B, (A \seq B) \seq Y}}
    {X, A \lsub B, A \lsub B \seq Y}}
    {X, A \lsub B \seq Y}
    \\\\
    \R[\rsf{\limp_L}]
      {\summ[$\pi_1$]{X, A \limp B \seq A, Y}}
      {\summ[$\pi_2$]{X, A \limp B, B \seq Y}}
      {X, A \limp B \seq Y}
    &\mt
    \R[\rsf{c{-}}]
    {\R[\rsf{{\limp}{-}}]
    {\prftree[r][d]{\rsf{c{-},c{+}}}
    {\prftree[r][d]{\rsf{f{-},f{+}}}
    {\prftree[r][dotted]{$\pi_1$}
    {\prftree[r][dotted]{$\pi_2$}
    {\prftree[r][d]{\rsf{p}}
    {\piq{}}
    {\piq{\piq{} \sep \piq{}}}}
    {\piq{\piq{} \sep X, A \limp B, B \seq Y}}}
    {\piq{X, A \limp B \seq A, Y \sep X, A \limp B, B \seq Y}}}
    {X, X, A \limp B, A \limp B \piq{\seq A \sep B \seq} Y, Y}}
    {X, A \limp B \piq{\seq A \sep B \seq} Y}}
    {X, A \limp B, A \limp B \seq Y}}
    {X, A \limp B \seq Y}
    \\\\
    \R[\rsf{\lsub_R}]
      {\summ[$\pi_1$]{X \seq A, A \lsub B, Y}}
      {\summ[$\pi_2$]{X, B \seq A \lsub B, Y}}
      {X \seq A \lsub B, Y}
    &\mt
    \R[\rsf{c{+}}]
    {\R[\rsf{{\lsub}{+}}]
    {\prftree[r][d]{\rsf{c{-},c{+}}}
    {\prftree[r][d]{\rsf{f{-},f{+}}}
    {\prftree[r][dotted]{$\pi_1$}
    {\prftree[r][dotted]{$\pi_2$}
    {\prftree[r][d]{\rsf{p}}
    {\piq{}}
    {\piq{\piq{} \sep \piq{}}}}
    {\piq{\piq{} \sep X, B \seq A \lsub B, Y}}}
    {\piq{X \seq A, A \lsub B, Y \sep X, B \seq A \lsub B, Y}}}
    {X, X \piq{\seq A \sep B \seq} A \lsub B, A \lsub B, Y, Y}}
    {X \piq{\seq A \sep B \seq} A \lsub B, Y}}
    {X \seq A \lsub B, A \lsub B, Y}}
    {X \seq A \lsub B, Y}
  \end{align*}
\end{proof}

\begin{lemma}[Simulation of \kl{G3cp}]
  If $\Gamma \prov{\kl{G3cp}} \Delta$, then $\Gamma \prov{\sysBH \cup
  \{\rsf{f{+}{+}}\} \setminus \{\rsf{i{\ua}}\}} \Delta$.
\end{lemma}
\begin{proof}
  By induction on the \kl{G3cp} derivation.

  \begin{align*}
    \R[]
      {}
      {a, \Gamma \seq \Delta, a}
    &\mt
    \R[\rsf{i{\da}}]
    {\prftree[r][d]{\rsf{w{-},w{+}}}
    {\piq{}}
    {\Gamma \piq{} \Delta}}
    {a, \Gamma \seq \Delta, a}
    \\\\
    \R[]
      {}
      {\bot, \Gamma \seq \Delta}
    &\mt
    \R[\rsf{\bot{-}}]
    {\prftree[r][d]{\rsf{w{-},w{+}}}
    {\piq{}}
    {\Gamma \piq{} \Delta}}
    {\bot, \Gamma \seq \Delta}
    \\\\
    \R[L\land]
    {\summ[$\pi_1$]{A, B, \Gamma \seq \Delta}}
    {A \land B, \Gamma \seq \Delta}
    &\mt
    \R[\rsf{\land{-}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {A, B, \Gamma \seq \Delta}}
    {A \land B, \Gamma \seq \Delta}
    \\\\
    \R[R\lor]
    {\summ[$\pi_1$]{\Gamma \seq \Delta, A, B}}
    {\Gamma \seq \Delta, A \lor B}
    &\mt
    \R[\rsf{\lor{+}}]
    {\prftree[r][dotted]{$\pi_1$}
    {\piq{}}
    {\Gamma \seq \Delta, A, B}}
    {\Gamma \seq \Delta, A \lor B}
    \\\\
    \R[R\land]
      {\summ[$\pi_1$]{\Gamma \seq \Delta, A}}
      {\summ[$\pi_2$]{\Gamma \seq \Delta, B}}
      {\Gamma \seq \Delta, A \land B}
    &\mt
    \R[\rsf{\land{+}}]
    {\prftree[r][d]{\rsf{c{-}},\rsf{c{+}}}
    {\prftree[r][d]{\rsf{f{-}},\rsf{f{+}}}
    {\prftree[r][dotted]{$\pi_1, \pi_2$}
    {\prftree[r][d]{\rsf{p}}
    {\piq{}}
    {\piq{\piq{} \sep \piq{}}}}
    {\piq{\Gamma \seq \Delta, A \sep \Gamma \seq \Delta, B}}}
    {\Gamma, \Gamma \piq{\seq A \sep \seq B} \Delta, \Delta}}
    {\Gamma \piq{\seq A \sep \seq B} \Delta}}
    {\Gamma \seq \Delta, A \land B}
    \\\\
    \R[L\lor]
      {\summ[$\pi_1$]{A, \Gamma \seq \Delta}}
      {\summ[$\pi_2$]{B, \Gamma \seq \Delta}}
      {A \lor B, \Gamma \seq \Delta}
    &\mt
    \R[\rsf{\lor{-}}]
    {\prftree[r][d]{\rsf{c{-}},\rsf{c{+}}}
    {\prftree[r][d]{\rsf{f{-}},\rsf{f{+}}}
    {\prftree[r][dotted]{$\pi_1, \pi_2$}
    {\prftree[r][d]{\rsf{p}}
    {\piq{}}
    {\piq{\piq{} \sep \piq{}}}}
    {\piq{A, \Gamma \seq \Delta \sep B, \Gamma \seq \Delta}}}
    {\Gamma, \Gamma \piq{A \seq \sep B \seq} \Delta, \Delta}}
    {\Gamma \piq{A \seq \sep B \seq} \Delta}}
    {A \lor B, \Gamma \seq \Delta}
    \\\\
    \R[L{\limp}]
      {\summ[$\pi_1$]{\Gamma \seq \Delta, A}}
      {\summ[$\pi_2$]{B, \Gamma \seq \Delta}}
      {A \limp B, \Gamma \seq \Delta}
    &\mt
    \R[\rsf{{\limp}{-}}]
    {\prftree[r][d]{\rsf{c{-}},\rsf{c{+}}}
    {\prftree[r][d]{\rsf{f{-}},\rsf{f{+}}}
    {\prftree[r][dotted]{$\pi_1, \pi_2$}
    {\prftree[r][d]{\rsf{p}}
    {\piq{}}
    {\piq{\piq{} \sep \piq{}}}}
    {\piq{\Gamma \seq \Delta, A \sep B, \Gamma \seq \Delta}}}
    {\Gamma, \Gamma \piq{\seq A \sep B \seq} \Delta, \Delta}}
    {\Gamma \piq{\seq A \sep B \seq} \Delta}}
    {A \limp B, \Gamma \seq \Delta}
    \\\\
    \R[R{\limp}]
      {\summ[$\pi_1$]{A, \Gamma \seq \Delta, B}}
      {\Gamma \seq \Delta, A \limp B}
    &\mt
    \R[\rsf{{\limp}{+}}]
    {\prftree[r][d]{\rsf{f{-}{+}{\da}}}
    {\prftree[r][d]{\rsf{f{+}{+}{\da}}}
    {\prftree[r][dotted]{$\pi_1$}
    {\R[\rsf{p{+}}]
    {\piq{}}
    {\seq (\piq{})}}
    {\seq (A, \Gamma \seq \Delta, B)}}
    {\seq \Delta, (A, \Gamma \seq B)}}
    {\Gamma \seq \Delta, (A \seq B)}}
    {\Gamma \seq \Delta, A \limp B}
  \end{align*}
\end{proof}