% Proof trees macros

\NewDocumentCommand{\rnm}{mO{}tr}
  {{\small$
    \IfBooleanT{#3}{\overline}{
      #1
    }^{#2}$}}

\NewDocumentCommand{\R}{oO{}trtd}{
  \expandafter\prftree\expanded{
    \IfBooleanT{#4}{[d]}
    \IfValueT{#1}{[r]{
      \unexpanded{\rnm{#1}}
      [#2]
      \IfBooleanT{#3}{r}
    }}
  }
}

\newcommand{\rsf}[1]{\text{\small$\mathsf{#1}$}}

\newcommand{\assum}{\prfassumption}
\newcommand{\summ}{\prfsummary}

% -------------------------------
% ---------- Notations ----------
% -------------------------------

% Long digression in the margin
\NewEnviron{digression}{
  \marginnote{
    \begin{kaodigression}
      \BODY
    \end{kaodigression}
  }
}

% Thick table lines
\makeatletter
\newcommand{\thickhline}{%
    \noalign {\ifnum 0=`}\fi \hrule height 1pt
    \futurelet \reserved@a \@xhline
}
\newcolumntype{"}{@{\hskip\tabcolsep\vrule width 1pt\hskip\tabcolsep}}
\makeatother

% \xleftrightarrow without mathtools
\makeatletter
\newcommand\xleftrightarrow[2][]{%
  \ext@arrow 9999{\longleftrightarrowfill@}{#1}{#2}}
\newcommand\longleftrightarrowfill@{%
  \arrowfill@\leftarrow\relbar\rightarrow}
\makeatother

% Small line break
\newcommand{\sbr}{~\\\vspace{-1em}}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcommand{\mt}{\qquad\mapsto\qquad}

\newcommand{\HOne}{\color{hypnum}\ding{172}}
\newcommand{\HTwo}{\color{hypnum}\ding{173}}
\newcommand{\HThree}{\color{hypnum}\ding{174}}
\newcommand{\HFour}{\color{hypnum}\ding{175}}
\newcommand{\HFive}{\color{hypnum}\ding{176}}

\newcommand{\Hyp}[1]{\colorbox{hyp}{#1}}

\newcommand{\bcase}{\textbf{Base case}}
\newcommand{\rcase}{\textbf{Recursive case}}

\newcommand{\Ceq}{\mathrel{\vcenter{\hbox{::}}{=}}}

\newrobustcmd\syneq{
  \mathrel{%
    \withkl{\kl[\syneq]}{%
      \cmdkl{\equiv}
    }%
  }%
}
\knowledge{\syneq}{notion}
\newrobustcmd\notsyneq{
  \mathrel{%
    \withkl{\kl[\syneq]}{%
      \cmdkl{\not\equiv}
    }%
  }%
}

\newcommand{\nats}{\mathbb{N}}

% Vertical and horizontal reflection in math mode
\newcommand{\hrefl}[1]{\text{\raisebox{\depth}{\scalebox{-1}[1]{$#1$}}}}
\newcommand{\vrefl}[1]{\text{\raisebox{\depth}{\scalebox{-1}[-1]{$#1$}}}}
\newcommand{\hvrefl}[1]{\text{\raisebox{\depth}{\scalebox{1}[-1]{$#1$}}}}

\newcommand{\sep}{\;\!;\!\;}

\newcommand{\defeq}{\triangleq}

\newcommand{\da}{\downarrow}
\newcommand{\ua}{\uparrow}

\newrobustcmd\seq{
  \mathrel{%
    \withkl{\kl[\seq]}{%
      \cmdkl{\Rightarrow}
    }%
  }%
}
\knowledge{\seq}{notion}

\newcommand{\limp}{\supset}
\newcommand{\lequiv}{\Leftrightarrow}
\newcommand{\lsub}{\subset}

\newcommand{\mcirc}{\mathbin{⚬}}
\newcommand{\mdiam}{◇}

\newrobustcmd\step[1]{\withkl{\kl[\step]}{\mathrel{\cmdkl{\rightarrow_{#1}}}}}
\knowledge{\step}{notion}
\knowledge{\step}{notion,scope=bubble}
\knowledge{\step}{notion,scope=eg}
\knowledge{\step}{notion,scope=flower}
\newrobustcmd\lstep[1]{\withkl{\kl[\lstep]}{\mathrel{\cmdkl{\rightharpoonup_{#1}}}}}
\knowledge{\lstep}{notion}
\knowledge{\lstep}{notion,scope=bubble}
\knowledge{\lstep}{notion,scope=flower}

\newrobustcmd\steps[1]{\withkl{\kl[\step]}{\mathrel{\cmdkl{\rightarrow^{\ast}_{#1}}}}}
\newrobustcmd\notstep[1]{\withkl{\kl[\step]}{\mathrel{\cmdkl{\nrightarrow_{#1}}}}}
\newrobustcmd\notsteps[1]{\withkl{\kl[\step]}{\mathrel{\cmdkl{\nrightarrow^{\ast}_{#1}}}}}
\newrobustcmd\nsteps[2]{\withkl{\kl[\step]}{\mathrel{\cmdkl{\rightarrow^{#1}_{#2}}}}}

\newrobustcmd\xlstep[1]{\withkl{\kl[\lstep]}{\mathrel{\cmdkl{\xrightharpoonup{#1}}}}}
\newrobustcmd\xstep[1]{\withkl{\kl[\step]}{\mathrel{\cmdkl{\xrightarrow{#1}}}}}
\newrobustcmd\xsteps[1]{\withkl{\kl[\step]}{\mathrel{\cmdkl{\xrightarrow{#1}\!\!\raisebox{3pt}[3pt]{\small$\ast$}~}}}}
\newrobustcmd\xinvstep[1]{\xleftrightarrow{#1}}

\newcommand{\deriv}[3]{#1 : #2 \steps{} #3}
\newcommand{\irule}[3]{#1 : #2 \step{} #3}
\newcommand{\rrule}[3]{#2 \step{#1} #3}

\newrobustcmd\sement[1]{
  \mathrel{%
    \withkl{\kl[\sement]}{%
      \cmdkl{\leq_{#1}}
    }%
  }%
}
\knowledge{\sement}{notion}

\newrobustcmd\semequiv[1]{
  \mathrel{%
    \withkl{\kl[\semequiv]}{%
      \cmdkl{\simeq_{#1}}
    }%
  }%
}
\knowledge{\semequiv}{notion}

\knowledgenewrobustcmd\bv{\cmdkl{\mathsf{bv}}}
\knowledgenewrobustcmd\fv{\cmdkl{\mathsf{fv}}}
\renewcommand{\emptyset}{⌀}
\newcommand{\subst}[3]{#1 \{ #2 / #3 \}}
\newcommand{\compr}[2]{\left\{#1 ~\middle|~ #2\right\}}
\newcommand{\substermscompl}[1]{\overline{#1}}
\knowledgenewrobustcmd\fset[3]{\cmdkl{\{}#3\cmdkl{\}_{#1}^{#2}}}

\newcommand{\hypo}[1]{{\color{hypo} #1}}
\newcommand{\conc}[1]{{\color{conc} #1}}
\newcommand{\dvar}[1]{{\color{dvar} #1}}

\newrobustcmd\prov[1]{
  \mathrel{%
    \withkl{\kl[\prov]}{%
      \cmdkl{\sststile{#1}{}}
    }%
  }%
}
\knowledge{\prov}{notion}

\newcommand{\dmdual}[1]{\overline{#1}}

\newrobustcmd\hole{\square}
\newrobustcmd\cfill[2]{#1\select{#2}}

% Bubbles

\newcommand{\cham}{\textsc{Cham}}

\newcommand{\bubbleT}[1]{\llparenthesis~#1~\rrparenthesis}
\newrobustcmd\piq[1]{
  \mathrel{%
    \withkl{\kl[\piq]}{%
      \cmdkl{\langle}#1\cmdkl{\rangle}
    }%
  }%
}
\knowledge{\piq}{notion}


\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,fill=white,inner sep=2pt] (char) {#1};}}
\newcommand*\bcircled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,fill=solved,inner sep=2pt] (char) {#1};}}
\newcommand*\gAcircled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,fill=genA,inner sep=2pt] (char) {#1};}}
\newcommand*\gBcircled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,fill=genB,inner sep=2pt] (char) {#1};}}

\newcommand*\fillcircled[2]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,fill=#1,inner sep=2pt] (char) {#2};}}


\newcommand{\bubble}[1]{\color{bubble}\circled{$#1$}}
\newcommand{\cbubble}[1]{\color{conc}\circled{$#1$}}
\newcommand{\hbubble}[1]{\color{hypo}\circled{$#1$}}

\newcommand{\bbubble}[1]{\color{bubble}\bcircled{$#1$}}
\newcommand{\hbbubble}[1]{\color{hypo}\bcircled{$#1$}}
\newcommand{\cbbubble}[1]{\color{conc}\bcircled{$#1$}}

\newcommand{\gAbubble}[1]{\color{bubble}\gAcircled{$#1$}}
\newcommand{\ggAbubble}[1]{\color{black}\gAcircled{$#1$}}
\newcommand{\hgAbubble}[1]{\color{hypo}\gAcircled{$#1$}}
\newcommand{\cgAbubble}[1]{\color{conc}\gAcircled{$#1$}}

\newcommand{\gBbubble}[1]{\color{bubble}\gBcircled{$#1$}}
\newcommand{\hgBbubble}[1]{\color{hypo}\gBcircled{$#1$}}
\newcommand{\cgBbubble}[1]{\color{conc}\gBcircled{$#1$}}

\newcommand{\bsheet}[1]{\colorbox{solved}{$#1$}}
\newcommand{\gAsheet}[1]{\colorbox{genA}{$#1$}}
\newcommand{\gBsheet}[1]{\colorbox{genB}{$#1$}}

\knowledgenewrobustcmd\aint[1]{\cmdkl{\llfloor} #1 \cmdkl{\rrfloor}}
\knowledgenewrobustcmd\sint[1]{\cmdkl{\llbracket} #1 \cmdkl{\rrbracket}}
\knowledgenewrobustcmd\psint[1]{\cmdkl{\llbracket} #1 \cmdkl{\rrbracket^+}}
\knowledgenewrobustcmd\nsint[1]{\cmdkl{\llbracket} #1 \cmdkl{\rrbracket^-}}

\newcommand{\identity}{\textsc{$\mathbb{I}$dentity}}
\newcommand{\flow}{\textsc{$\mathbb{F}$low}}
\newcommand{\resource}{\textsc{$\mathbb{R}$esource}}
\newcommand{\heating}{\textsc{$\mathbb{H}$eating}}
\newcommand{\membrane}{\textsc{$\mathbb{M}$embrane}}

\knowledgenewrobustcmd\subsol{\mathrel{\cmdkl{\prec}}}

\newcommand{\deq}{\coloneq}
\newcommand{\ldef}[2]{#1 \deq #2}

\newrobustcmd\mix{
  \mathbin{%
    \withkl{\kl[\mix]}{%
      \cmdkl{\cupdot}
    }%
  }%
}
\knowledge{\mix}{notion}

\newcommand{\J}{\mathbin{\rhd}}
\newcommand{\JB}{\mathbin{\RHD}}

\newcommand{\ltop}{\top}
\newcommand{\lbot}{\bot}
\newcommand{\lmeet}{\land}
\newcommand{\ljoin}{\lor}
\newcommand{\lexp}{\limp}
\newcommand{\lcoexp}{\lsub}

\newrobustcmd\cdepth[1]{\withkl{\kl[\cdepth]}{\cmdkl{|}#1\cmdkl{|}}}
\knowledge{\cdepth}{notion,scope=sfl}
\knowledge{\cdepth}{notion,scope=symm}
\knowledge{\cdepth}{notion,scope=eg}
\knowledge{\cdepth}{notion,scope=flower}
\newrobustcmd\sdepth[1]{\withkl{\kl[\sdepth]}{\cmdkl{|}#1\cmdkl{|}}}
\knowledge{\sdepth}{notion,scope=sfl}
\knowledge{\sdepth}{notion,scope=symm}
\knowledge{\sdepth}{notion,scope=eg}
\knowledge{\sdepth}{notion,scope=flower}

\knowledgenewrobustcmd\soldual[1]{#1^{\cmdkl{\dagger}}}

\knowledgenewrobustcmd\Lattice{\cmdkl{\mathcall{L}}}
\knowledgenewrobustcmd\Heyting{\cmdkl{\mathcall{H}}}
\knowledgenewrobustcmd\Brouwer{\cmdkl{\mathcall{B}}}
\knowledgenewrobustcmd\HeytingBrouwer{\cmdkl{\mathcall{H\!B}}}
\knowledgenewrobustcmd\Boolean{\cmdkl{\mathcall{C}}}
\newcommand{\ACVar}{\mathcall{X}}
\newcommand{\sementL}{\sement{\Lattice}}
\newcommand{\sementH}{\sement{\Heyting}}
\newcommand{\sementB}{\sement{\Brouwer}}
\newcommand{\sementHB}{\sement{\HeytingBrouwer}}
\newcommand{\sementC}{\sement{\Boolean}}
\newcommand{\sementX}{\sement{\ACVar}}

\newcommand{\sysB}{\kl[system~B]{B}}
\newcommand{\sysBH}{B_{\!\Heyting}}
\newcommand{\sysBB}{B_{\!\Brouwer}}
\newcommand{\sysBHB}{B_{\!\HeytingBrouwer}}

\newcommand{\psintAnd}[3]{\bigwedge_{#1 \in #2}{\psint{#3}}}
\newcommand{\psintAndMix}[4]{\psintAnd{#1}{#2}{#1 \mix (#3 \seq #4)}}
\newcommand{\nsintOr}[3]{\bigvee_{#1 \in #2}{\psint{#3}}}
\newcommand{\nsintOrMix}[4]{\nsintOr{#1}{#2}{#1 \mix (#3 \seq #4)}}

\newcommand{\cS}{\mathcal{S}}

\newcommand{\dseq}{\mathbin{\Rightarrow}}
\newcommand{\dtrans}[1]{\begingroup #1 \endgroup^{\scalebox{1.25}{$\bullet$}}}

\newcommand{\pol}[1]{\mathsf{pol}(#1)}

\knowledgenewrobustcmd\imps[1]{\cmdkl{\mathsf{imp}}(#1)}

% Existential Graphs

\knowledgenewrobustcmd\SA{\cmdkl{\textsc{\small SA}}}

\newcommand{\psheet}[1]{\color{pbg}{#1}}
\newcommand{\nsheet}[1]{\color{nfg}\colorbox{nbg}{$#1$}}
\newcommand{\pcut}[1]{\color{pfg}\fillcircled{pbg}{\color{pfg}$#1$}}
\newcommand{\ncut}[1]{\color{nfg}\fillcircled{nbg}{\color{nfg}$#1$}}

\newcommand{\opcut}[1]{\color{white}\fillcircled{white}{\color{black}$#1$}}
\newcommand{\oncut}[1]{\color{black}\fillcircled{black}{\color{white}$#1$}}

\knowledgenewrobustcmd\atoms{\cmdkl{\mathcal{A}}}

\knowledgenewrobustcmd\acut[1]{\cmdkl{[}#1\cmdkl{]}}

\knowledgenewrobustcmd\anodes{\cmdkl{\symbf{N_\alpha}}}
\knowledgenewrobustcmd\agraphs{\cmdkl{\symbf{G_\alpha}}}

\knowledgenewrobustcmd\bnodes{\cmdkl{\symbf{N_\beta}}}
\knowledgenewrobustcmd\bgardens{\cmdkl{\symbf{\Gamma_\beta}}}
\knowledgenewrobustcmd\bgraphs{\cmdkl{\symbf{G_\beta}}}

\knowledgenewrobustcmd\bcut[1]{\cmdkl{[}#1\cmdkl{]}}
\knowledgenewrobustcmd\bgarden[2]{#1 \mathbin{\cmdkl{\cdot}} #2}


\knowledgenewrobustcmd\strans[1]{\begingroup #1 \endgroup^{\cmdkl{\scalebox{1.25}{$\bullet$}}}}

\newcommand{\itsrc}[1]{\begingroup\setlength{\fboxrule}{0.8pt}\setlength{\fboxsep}{2pt}\color{itsrc}\fbox{\color{black}$#1$}\endgroup}
\newcommand{\itdst}[1]{\colorbox{itdst}{$#1$}}
\newcommand{\ins}[1]{\colorbox{ins}{$#1$}}
\newcommand{\dcut}[1]{\colorbox{dcut}{$#1$}}

\newcommand{\ljustif}{\mathbin{\succeq_0}}
\newcommand{\gjustif}{\mathbin{\succeq}}

\knowledgenewrobustcmd\subgraph{\mathrel{\cmdkl{\prec}}}

\newcommand{\westhook}[2]{
  \node[anchor=east,shape=diamond,draw,fill=white,inner sep=1pt] (#1) at (#2.west) {}
}
\newcommand{\easthook}[2]{
  \node[anchor=west,shape=diamond,draw,fill=white,inner sep=1pt] (#1) at (#2.east) {}
}
\newcommand{\northhook}[2]{
  \node[anchor=south,shape=diamond,draw,fill=white,inner sep=1pt] (#1) at (#2.north) {}
}
\newcommand{\southhook}[2]{
  \node[anchor=north,shape=diamond,draw,fill=white,inner sep=1pt] (#1) at (#2.south) {}
}
\newcommand{\northeasthook}[2]{
  \node[anchor=south west,shape=diamond,draw,fill=white,inner sep=1pt] (#1) at (#2.north east) {}
}
\newcommand{\northwesthook}[2]{
  \node[anchor=south east,shape=diamond,draw,fill=white,inner sep=1pt] (#1) at (#2.north west) {}
}
\newcommand{\southeasthook}[2]{
  \node[anchor=north west,shape=diamond,draw,fill=white,inner sep=1pt] (#1) at (#2.south east) {}
}
\newcommand{\southwesthook}[2]{
  \node[anchor=north east,shape=diamond,draw,fill=white,inner sep=1pt] (#1) at (#2.south west) {}
}

\newcommand{\ter}[2]{
\node[isosceles triangle,draw,minimum size=5pt,inner sep=0pt,fill=black] (#1) at (#2) {};
}
\newcommand{\coter}[2]{
\node[isosceles triangle,draw,minimum size=5pt,inner sep=0pt,fill=black,rotate=180] (#1) at (#2) {};
}
\newcommand{\terid}[2]{
\ter{#1}{#2}
\node[inner sep=0] (#1-in-top) at ($(#1.left corner) + (-1,+0.5)$) {};
\node[inner sep=0] (#1-in-bot) at ($(#1.right corner) + (-1,-0.5)$) {};
\node[inner sep=0] (#1-out) at ($(#1.apex) + (1,0)$) {};
\draw (#1.left corner) ..controls (#1.left corner) and ($(#1.left corner) + (0,0.55)$).. (#1-in-top);
\draw (#1.right corner) ..controls (#1.right corner) and ($(#1.right corner) - (0,0.55)$).. (#1-in-bot);
\draw ($(#1.apex) - (0.1,0)$) -- (#1-out);
}
\newcommand{\coterid}[2]{
\coter{#1}{#2}
\node[inner sep=0] (#1-out-top) at ($(#1.left corner) + (+1,-0.5)$) {};
\node[inner sep=0] (#1-out-bot) at ($(#1.right corner) + (+1,+0.5)$) {};
\node[inner sep=0] (#1-in) at ($(#1.apex) - (1,0)$) {};
\draw (#1.left corner) ..controls (#1.left corner) and ($(#1.left corner) - (0,0.55)$).. (#1-out-top);
\draw (#1.right corner) ..controls (#1.right corner) and ($(#1.right corner) + (0,0.55)$).. (#1-out-bot);
\draw ($(#1.apex) + (0.1,0)$) -- (#1-in);
}

\newcommand{\binder}[2]{
  \node[draw,circle,fill=black,inner sep=0,minimum size=3pt] (#1) at (#2) {};
}

% Flowers

\newrobustcmd\entails[1]{\mathrel{\withkl{\kl[\entails]}{\cmdkl{\vdash_{#1}}}}}
\knowledge{\entails}{notion}
\newrobustcmd\nentails[1]{\withkl{\kl[\entails]}{\mathrel{\cmdkl{\nvdash_{#1}}}}}

% \newcommand{\Nature}{\symbol{"2740}}
% \newcommand{\Culture}{\symbol{"273F}}
\knowledgenewrobustcmd\Nature{\cmdkl{\text{\ding{96}}}}
\knowledgenewrobustcmd\Culture{\cmdkl{\text{\ding{34}}}}

\newrobustcmd\flower[2]{#1\mathrel{\withkl{\kl[\flower]}{\cmdkl{\csup}}}#2}
\knowledge{\flower}{notion}
\knowledgenewrobustcmd\garden[2]{#1\mathbin{\cmdkl{\cdot}}#2}

\knowledgenewrobustcmd\flowers{\cmdkl{\mathbb{F}}}
\knowledgenewrobustcmd\gardens{\cmdkl{\mathbb{G}}}

\knowledgenewrobustcmd\interp[1]{\cmdkl{\lBrack}#1\cmdkl{\rBrack}}

\knowledgenewrobustcmd\chyp[2]{#1 \mathrel{\cmdkl{\succ}} #2}

\directlua{flower = require("flower")}
\newcommand{\DrawFlowers}[1]{\directlua{flower.many({#1})}}

\newcommand{\pissheet}[1]{\colorbox{pistil}{$#1$}}

\newcommand{\bx}{\symbf{x}}
\newcommand{\by}{\symbf{y}}
\newcommand{\bz}{\symbf{z}}

\knowledgenewrobustcmd\atomoccs[1]{\cmdkl{\mathcall{A}(#1)}}
\knowledgenewrobustcmd\vehicle[1]{\cmdkl{\mathcall{V}}(#1)}
\knowledgenewrobustcmd\anchor[1]{\cmdkl{\vrefl{\mathcall{V}}}(#1)}
\knowledgenewrobustcmd\lca[2]{\cmdkl{\mathsf{lca}}(#1,#2)}

\newrobustcmd\cinter{\mathrel{\withkl{\kl[\cinter]}{\cmdkl{\bowtie}}}}
\knowledge{\cinter}{notion}
\newrobustcmd\cinterpos{\withkl{\kl[\cinter]}{\mathrel{\cmdkl{\stackon[1pt]{$\cinter$}{$\scriptstyle +$}}}}}
\newrobustcmd\cinterneg{\withkl{\kl[\cinter]}{\mathrel{\cmdkl{\stackon[1pt]{$\cinter$}{$\scriptstyle -$}}}}}

\newrobustcmd\sinter{\withkl{\kl[\sinter]}{\mathrel{\cmdkl{\hrefl{\propto}}}}}
\knowledge{\sinter}{notion}
\newrobustcmd\sinterpos{\withkl{\kl[\sinter]}{\mathrel{\cmdkl{\stackon[1pt]{$\sinter$}{$\scriptstyle +$}}}}}
\newrobustcmd\sinterneg{\withkl{\kl[\sinter]}{\mathrel{\cmdkl{\stackon[1pt]{$\sinter$}{$\scriptstyle -$}}}}}

\knowledgenewrobustcmd\justi{\mathbin{\cmdkl{\hookrightarrow}}}
\knowledgenewrobustcmd\compat{\mathbin{\cmdkl{\da}}}

\newcommand{\Proof}{\begingroup \textsc{Proof} \endgroup}
\newcommand{\Edit}{\begingroup \textsc{Edit} \endgroup}
\newcommand{\Navigation}{\begingroup \textsc{Navigation} \endgroup}

% First-order

\newrobustcmd\vars{\withkl{\kl[\vars]}{\cmdkl{\mathscr{V}}}}
\knowledge{\vars}{notion,scope=eg}
\knowledge{\vars}{notion,scope=flower}
\knowledgenewrobustcmd\fsymbs{\cmdkl{\mathscr{F}}}
\knowledgenewrobustcmd\psymbs{\cmdkl{\mathscr{P}}}
\knowledgenewrobustcmd\arity{\cmdkl{\mathsf{ar}}}
\knowledgenewrobustcmd\dom{\cmdkl{\mathsf{supp}}}
\knowledgenewrobustcmd\terms{\cmdkl{\mathbb{T}}}
\knowledgenewrobustcmd\csts{\cmdkl{\mathbb{C}}}

\newrobustcmd\upd[1]{\withkl{\kl[\upd]}{\mathbin{\cmdkl{|_{#1}}}}}
\knowledge{\upd}{notion}
\newcommand{\update}[3]{#1 \upd{#2} #3}
\newcommand{\restr}[2]{#1\!\upd{#2}\!}
\knowledgenewrobustcmd\idsubst{\cmdkl{\mathsf{1}}}
\newcommand{\cstsubst}[1]{\overline{#1}}

\newcommand{\tvec}[1]{\vec{\symbf{#1}}}

% Kripke

% \newcommand{\rewolF}[1]{\symbol{2702}(#1)}
\knowledgenewrobustcmd\rewolF[1]{\cmdkl{\text{\ding{95}}}(#1)}

\newrobustcmd\kentails[1]{\mathrel{\withkl{\kl[\kentails]}{\cmdkl{\vDash_{#1}}}}}
\knowledge{\kentails}{notion}
\newrobustcmd\notkentails[1]{\mathrel{\withkl{\kl[\kentails]}{\cmdkl{\nvDash_{#1}}}}}
\newrobustcmd\kequiv[1]{\mathrel{\withkl{\kl[\kequiv]}{\cmdkl{\vrefl{{\vDash}} {\vDash}_{#1}}}}}
\knowledge{\kequiv}{notion}

\knowledgenewrobustcmd\evaluation[1]{\cmdkl{$#1$-evaluation}}
\knowledgenewrobustcmd\consistent[1]{\cmdkl{$#1$-consistent}}
\knowledgenewrobustcmd\complete[1]{\cmdkl{$#1$-complete}}
\newrobustcmd\consistency[1]{\withkl{\kl[\consistent]}{\cmdkl{$#1$-consistency}}}
\newrobustcmd\completeness[1]{\withkl{\kl[\complete]}{\cmdkl{$#1$-completeness}}}

\knowledgenewrobustcmd\eforces[3]{#1\mathrel{\cmdkl{\Vdash}}#2\,\cmdkl{[}#3\cmdkl{]}}
\newrobustcmd\neforces[3]{\withkl{\kl[\eforces]}{#1\mathrel{\cmdkl{\nVdash}}#2\,\cmdkl{[}#3\cmdkl{]}}}

\newrobustcmd\access{
  \mathrel{%
    \withkl{\kl[\access]}{%
      \cmdkl{\leq}
    }%
  }%
}
\knowledge{\access}{notion}
\newrobustcmd\revaccess{
  \mathrel{%
    \withkl{\kl[\access]}{%
      \cmdkl{\geq}
    }%
  }%
}

\knowledgenewrobustcmd\completion[1]{\cmdkl{\mathsf{Com}}(#1)}
\knowledgenewrobustcmd\ncompletion[2]{\cmdkl{\mathsf{Com}^{#2}}(#1)}

\newcommand{\tT}{\mathcall{T}}
\newcommand{\tU}{\mathcall{U}}

% Actema

\newrobustcmd\forw{
  \mathrel{%
    \withkl{\kl[\forw]}{%
      \cmdkl{\varoast}
    }%
  }%
}
\knowledge{\forw}{notion}

\newrobustcmd\back{
  \mathrel{%
    \withkl{\kl[\back]}{%
      \cmdkl{\varogreaterthan}
    }%
  }%
}
\knowledge{\back}{notion}

\newrobustcmd\para{
  \mathrel{%
    \withkl{\kl[\para]}{%
      \cmdkl{\varobar}
    }%
  }%
}
\knowledge{\para}{notion}

\DeclareMathOperator{\link}{\mathrel{@}}

\newcommand{\rever}{^*}
\newrobustcmd\lint[1]{\withkl{\kl[\lint]}{\cmdkl{\lfloor}#1\cmdkl{\rfloor}}}
\knowledge{\lint}{notion}

\DeclareRobustCommand{\sys}[1]{\text{$\mathsf{#1}$}}
\newcommand{\pair}[2]{\left\langle #1, #2 \right\rangle}

\newcommand{\ra}{\rightarrow}
\newcommand{\FV}{\mbox{FV}}
\newcommand{\ocp}{\square_+}
\newcommand{\ocn}{\square_-}
\newcommand{\uA}{\select{A}}
\newcommand{\uB}{\select{B}}
\newcommand{\uC}{\select{C}}
\newcommand{\select}[1]{\fbox{$#1$}}
\newcommand{\stepto}{~~~~\mapsto~~~}
\knowledgenewrobustcmd\inv{\cmdkl{\mathsf{inv}}}
\knowledgenewrobustcmd\uvars{\cmdkl{\mathsf{U}}}
\knowledgenewrobustcmd\lvar{\cmdkl{l}}
\knowledgenewrobustcmd\lvarp{\cmdkl{l^+}}
\knowledgenewrobustcmd\lvarn{\cmdkl{l^-}}

\newcommand{\mother}{\mbox{\textsf{mother}}}
\newcommand{\rich}{\mbox{\textsf{Rich}}}
\newcommand{\human}{\mbox{\textsf{Human}}}
\newcommand{\mortal}{\mbox{\textsf{Mortal}}}
\newcommand{\socrates}{\mbox{\textsf{Socrates}}}

\newcommand{\injective}{\mbox{\textsf{injective}}}

\newcommand{\action}[1]{\textsf{#1}}
\newcommand{\process}[1]{\textsf{#1}}
\newcommand{\request}[1]{\texttt{#1}}
\knowledgenewrobustcmd\trgoal[1]{\cmdkl{\llbracket} #1 \cmdkl{\rrbracket}}
\knowledgenewrobustcmd\traction[1]{\cmdkl{\llparenthesis} #1 \cmdkl{\rrparenthesis}}
\knowledgenewrobustcmd\subterms[1]{#1\cmdkl{\downzigzagarrow}}

\newcommand{\ssreflect}{\textsc{SSReflect}}

\knowledgenewrobustcmd\suc[1]{#1\cmdkl{\oplus}1}
% \newcommand{\suc}[1]{S(#1)}

% Type theory

\newcommand{\Prop}{\mathsf{Prop}}
